<div class="container-fluid px-0 py-5 my-5">
  <div class="row mx-0">
    <div class="col px-4 text-center">

      <h1 class="white-text"><%= t("users.index.title") %></h1>

      <ul class="list-group">
        <% @users.each do |user| %>
          <li class="list-group-item">
            <%= link_to user do %>
              <img src="<%= user.image %>" width="50" height="50" style="display: block; margin: auto;">
              <%= user.name %>
            <% end %>
            <% if current_user %>
              <% if current_user.following?(user) %>
                <%= form_with(model: current_user.active_relationships.find_by(followed: user), html: { method: :delete }) do |f| %>
                  <div><%= hidden_field_tag :redirect_to, request.fullpath %></div>
                  <%= f.submit t("users.show.unfollow"), class: "btn btn-secondary" %>
                <% end %>
              <% elsif current_user != user %>
                <%= form_with(model: current_user.active_relationships.build) do |f| %>
                  <div><%= hidden_field_tag :redirect_to, request.fullpath %></div>
                  <div><%= hidden_field_tag :followed_id, user.id %></div>
                  <%= f.submit t("users.show.follow"), class: "btn btn-primary" %>
                <% end %>
              <% end %>
            <% end %>
          </li>
        <% end %>
      </ul>

      <div class="d-flex justify-content-center mt-5">
        <%= paginate @users, theme: "bootstrap-5" %>
      </div>

    </div>
  </div>
</div>
